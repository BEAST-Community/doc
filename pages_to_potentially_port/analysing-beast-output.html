<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="BEAST_favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="12.html" />
<link rel="canonical" href="analysing-beast-output.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>Analysing BEAST Output | BEAST</title>
  <style type="text/css" media="all">
@import url("system.base.css%3Fou07bk.css");
@import url("system.menus.css%3Fou07bk.css");
@import url("system.messages.css%3Fou07bk.css");
@import url("system.theme.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("field.css%3Fou07bk.css");
@import url("node.css%3Fou07bk.css");
@import url("search.css%3Fou07bk.css");
@import url("user.css%3Fou07bk.css");
@import url("ckeditor.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("style.css%3Fou07bk.css");
</style>
<style type="text/css" media="print">
@import url("print.css%3Fou07bk.css");
</style>

<!--[if lt IE 7]>
<link type="text/css" rel="stylesheet" href="http://sbsweb2-bak.bio.ed.ac.uk/beast/themes/garland/fix-ie.css?ou07bk" media="all" />
<![endif]-->
  <script type="text/javascript" src="jquery.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="jquery.once.js%3Fv=1.2"></script>
<script type="text/javascript" src="drupal.js%3Fou07bk"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/beast\/","pathPrefix":"","ajaxPageState":{"theme":"garland","theme_token":"4jnRwjAQ0AfWewS35xnDlnKRjFDySa88YQTKJGWINqU","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ckeditor\/css\/ckeditor.css":1,"themes\/garland\/style.css":1,"themes\/garland\/print.css":1,"themes\/garland\/fix-ie.css":1}}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-12 node-type-article fluid-width" >
  <div id="skip-link">
    <a href="analysing-beast-output.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
      
  <div id="wrapper">
    <div id="container" class="clearfix">

      <div id="header">
        <div id="logo-floater">
                              <div id="branding"><strong><a href="index.html">
                          <img src="beast.png" alt="BEAST " title="BEAST " id="logo" />
                        <span>BEAST</span>            </a></strong></div>
                          </div>

        <h2 class="element-invisible">Main menu</h2><ul class="links inline main-menu"><li class="menu-230 first"><a href="index.html">Home</a></li>
<li class="menu-307"><a href="programs.html">Programs</a></li>
<li class="menu-329"><a href="downloads.html">Downloads</a></li>
<li class="menu-312 active-trail"><a href="tutorials.html" title="Tutorials and documentation on using BEAST" class="active-trail">Tutorials</a></li>
<li class="menu-326"><a href="error-messages.html">Error Messages</a></li>
<li class="menu-313 last"><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
</ul>              </div> <!-- /#header -->

      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="index.html">Home</a> › <a href="tutorials.html" title="Tutorials and documentation on using BEAST">Tutorials</a></div>                    <a id="main-content"></a>
          <div id="tabs-wrapper" class="clearfix">                                <h1 class="with-tabs">Analysing BEAST Output</h1>
                              </div>                                                  <div class="clearfix">
            <div id="node-12" class="node node-article node-promoted" about="/beast/analysing-beast-output" typeof="sioc:Item foaf:Document">

  
      <span property="dc:title" content="Analysing BEAST Output" class="rdf-meta element-hidden"></span>
      <span class="submitted"><span property="dc:date dc:created" content="2014-08-14T11:27:57+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Thu, 08/14/2014 - 11:27 — <span class="username" xml:lang="" about="/beast/users/rambaut" typeof="sioc:UserAccount" property="foaf:name" datatype="">rambaut</span></span></span>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p><a href="home.html" title="Main Page">BEAST Documentation</a>-&gt;<a href="tutorials.html" title="Tutorials">Tutorials</a>-&gt; Analysing BEAST output</p>
<p><a id="Analysing_BEAST_output_using_Tracer" name="Analysing_BEAST_output_using_Tracer"></a></p>
<h2>Analysing BEAST output using Tracer</h2>
<p>This document provides a step-by-step tutorial to analysing the output of <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/BEAST" title="BEAST">BEAST</a> in a GUI application called <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Tracer" title="Tracer">Tracer</a>.</p>
<p><a id="Running_Tracer" name="Running_Tracer"></a></p>
<h3>Running Tracer</h3>
<p>The exact instructions for running <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Tracer" title="Tracer">Tracer</a> differs depending on which computer you are using. Please see the README text file that was distributed with the version you downloaded.</p>
<p>Once running, <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Tracer" title="Tracer">Tracer</a> will look similar irrespective of which computer system it is running on. For this tutorial, the Mac OS X version will be shown but the Linux &amp; Windows versions will have exactly the same layout and functionality.</p>
<p><a id="Loading_the_BEAST_log_files" name="Loading_the_BEAST_log_files"></a></p>
<h3>Loading the BEAST log files</h3>
<p>Select the Open option from the File menu. If you have it available, select the log file that you created in the [first tutorial|Tutorial 1]. The file will load and you will presented with a window similar to the one below. Remember that BEAST is a stochastic program so the actual numbers will not be exactly the same.</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer0.png" title="tracer0.png"><img alt="tracer0.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/6/62/Tracer0.png" /></a></p>
<p>On the left hand side is the name of the log file loaded and the traces that it contains. There are traces for the likelihood (this is the combined log likelihood of the tree and the coalescent model), and the continuous parameters. Selecting a trace on the left brings up analyses for this trace on the right hand side depending on tab that is selected. In the picture above, the log likelihood trace is selected and various statistics of this trace is shown under the Estimates tab.</p>
<p>Note that the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#ESS" title="Glossary">Effective Sample Sizes(ESSs)</a> for all the traces are small (ESSs less than 100 are highlighted in red by Tracer). This is not good. A low ESS means that the trace contained a lot of correlated samples and thus may not represent the posterior distribution well. In the bottom right of the window is a frequency plot of the samples which as expected given the low ESSs is extremely rough.</p>
<p>In the top right of the window is a table of calculated statistics for the selected trace. The statistics and their meaning are described in the table below.</p>
<p>Mean</p>
<p>The mean value of the sampled trace across the chain (excluding the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#Burn-In" title="Glossary">burn-in</a>).</p>
<p>Stdev</p>
<p>The standard deviation of the mean. This takes into account the effective sample size so a small ESS will give a large Stdev.</p>
<p>Median</p>
<p>The median value of the sampled trace across the chain (excluding the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#Burn-In" title="Glossary">burn-in</a>).</p>
<p>95% HPD Lower</p>
<p>The lower bound of the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#HPD" title="Glossary">highest posterior density (HPD)</a> interval. The HPD is a credible set that contains 95% of the sampled values.</p>
<p>95% HPD Upper</p>
<p>The upper bound of the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#HPD" title="Glossary">highest posterior density (HPD)</a> interval. The HPD is a credible set that contains 95% of the sampled values.</p>
<p>Auto-Correlation Time (ACT)</p>
<p>The number of states in the MCMC chain that two samples have to be from each other for them to be uncorrelated. The <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#ACT" title="Glossary">ACT</a> is estimated from the samples in the trace (excluding the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#Burn-In" title="Glossary">burn-in</a>).</p>
<p>Effective Sample Size (ESS)</p>
<p>The <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#ESS" title="Glossary">ESS</a> is the number of independent samples that the trace is equivalent to. This is essentially the chain length (excluding the <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#Burn-In" title="Glossary">burn-in</a>) divided by the ACT.</p>
<p>If we select the Trace we can view the raw trace, that is, the sampled values against the step in the MCMC chain:</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer1.png" title="tracer1.png"><img alt="tracer1.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/1/1d/Tracer1.png" /></a></p>
<p>Here you can see how the samples are correlated. There are only 100 samples in the trace (we ran the MCMC for 100,000 steps sampling every 1000) but it is clear that adjacent samples often tend to have similar values. The ESS for the likelihood is about 50 so we are only getting half the amount of independent samples as actual samples.</p>
<p>Essentially this simply looks as if we need to run the chain for longer. Given the lowest ESS (for the coalescent likelihood) is 27, it would suggest that we have to run it for 4 times longer to get ESSs that are &gt; 100. However it would be better to aim higher so lets go for a chain length of 1,000,000. Go back to [Tutorial 1] and create a new BEAST XML file with a longer chain length. Now run BEAST and load the new log file into Tracer (you need to quit and restart Tracer to clear out the old log file).</p>
<p>You should now have something like this:</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer2.png" title="tracer2.png"><img alt="tracer2.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/5/50/Tracer2.png" /></a></p>
<p>This is much better. The ESSs are now all &gt; 350 and the frequency plot is starting to show a reasonable curve. Click on the Trace tab and look at the raw trace plot:</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer3.png" title="tracer3.png"><img alt="tracer3.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/2/2c/Tracer3.png" /></a></p>
<p>Again this is more like what we are aiming for - we call this plot the hairy catapiller. There are now 1000 samples making up this plot and with an ESS of about 500 there is still auto-correlation between the samples but 500 effectively independent samples is pretty respectable. There are no obvious trends in the plot suggesting that the MCMC was still converging and there are no large-scale fluctuations in the trace suggesting poor <a href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/Glossary#Mixing" title="Glossary">mixing</a>. Diagnosis of trace plots will be delt with in a another tutorial.</p>
<p>As we are happy with the behaviour of log-likelihood we can now move on to one of the parameters of interest: mutation rate. Select siteModel1.mu in the left-hand table. This is the mutation rate of the first codon position. Now choose the density plot by selecting the tab labelled Density. This shows a plot of the posterior probability density of this parameter. You should see a plot similar to this one:</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer4.png" title="tracer4.png"><img alt="tracer4.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/a/a2/Tracer4.png" /></a></p>
<p>As you can see the posterior probability density is a reasonable looking bell-shaped curve. There is some stochastic noise which would be reduced if we ran the chain for longer but we already have a pretty good estimate of the mean and credible interval. You can overlay the density plots of multiple traces in order to compare them (it is up to the user whether they are comparable on the the same axis or not). Select the mutation rates for all three codon positions in the table to the left. You can either click and drag to select multiple traces or click on the top trace and shift-click on the bottom trace. You will now see the posterior probability densities for the mutation rate at all three codon positions over-layed:</p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer5.png" title="tracer5.png"><img alt="tracer5.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/4/45/Tracer5.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer6.png" title="tracer6.png"><img alt="tracer6.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/5/55/Tracer6.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer7.png" title="tracer7.png"><img alt="tracer7.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/e/e8/Tracer7.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer8.png" title="tracer8.png"><img alt="tracer8.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/5/54/Tracer8.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer9.png" title="tracer9.png"><img alt="tracer9.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/e/ee/Tracer9.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer10.png" title="tracer10.png"><img alt="tracer10.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/7/7d/Tracer10.png" /></a></p>
<p><a class="image" href="https://web.archive.org/web/20130125173544/http://beast.bio.ed.ac.uk/File:Tracer11.png" title="tracer11.png"><img alt="tracer11.png" src="https://web.archive.org/web/20130125173544im_/http://beast.bio.ed.ac.uk/w/images/0/00/Tracer11.png" /></a></p>
<hr /><p><a href="tutorials.html" title="Tutorials">Return to Tutorials</a></p>
</div></div></div>  </div>

  <div class="clearfix">
          <div class="links"></div>
    
      </div>

</div>
          </div>
                          </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

      
    </div> <!-- /#container -->
  </div> <!-- /#wrapper -->
  </body>
</html>
