<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="BEAST_favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="28.html" />
<link rel="canonical" href="nucleotide-substitution-models.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>Nucleotide Substitution Models | BEAST</title>
  <style type="text/css" media="all">
@import url("system.base.css%3Fou07bk.css");
@import url("system.menus.css%3Fou07bk.css");
@import url("system.messages.css%3Fou07bk.css");
@import url("system.theme.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("field.css%3Fou07bk.css");
@import url("node.css%3Fou07bk.css");
@import url("search.css%3Fou07bk.css");
@import url("user.css%3Fou07bk.css");
@import url("ckeditor.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("style.css%3Fou07bk.css");
</style>
<style type="text/css" media="print">
@import url("print.css%3Fou07bk.css");
</style>

<!--[if lt IE 7]>
<link type="text/css" rel="stylesheet" href="http://sbsweb2-bak.bio.ed.ac.uk/beast/themes/garland/fix-ie.css?ou07bk" media="all" />
<![endif]-->
  <script type="text/javascript" src="jquery.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="jquery.once.js%3Fv=1.2"></script>
<script type="text/javascript" src="drupal.js%3Fou07bk"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/beast\/","pathPrefix":"","ajaxPageState":{"theme":"garland","theme_token":"dYppJGa-n6sP9wLpOswTYfhzVCS2WD_zL1094R2UX7g","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ckeditor\/css\/ckeditor.css":1,"themes\/garland\/style.css":1,"themes\/garland\/print.css":1,"themes\/garland\/fix-ie.css":1}}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-28 node-type-article fluid-width" >
  <div id="skip-link">
    <a href="Nucleotide-Substitution-Models.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
      
  <div id="wrapper">
    <div id="container" class="clearfix">

      <div id="header">
        <div id="logo-floater">
                              <div id="branding"><strong><a href="index.html">
                          <img src="beast.png" alt="BEAST " title="BEAST " id="logo" />
                        <span>BEAST</span>            </a></strong></div>
                          </div>

        <h2 class="element-invisible">Main menu</h2><ul class="links inline main-menu"><li class="menu-230 first"><a href="index.html">Home</a></li>
<li class="menu-307"><a href="programs.html">Programs</a></li>
<li class="menu-329"><a href="downloads.html">Downloads</a></li>
<li class="menu-312"><a href="tutorials.html" title="Tutorials and documentation on using BEAST">Tutorials</a></li>
<li class="menu-326"><a href="error-messages.html">Error Messages</a></li>
<li class="menu-313 last"><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
</ul>              </div> <!-- /#header -->

      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="index.html">Home</a></div>                    <a id="main-content"></a>
          <div id="tabs-wrapper" class="clearfix">                                <h1 class="with-tabs">Nucleotide Substitution Models</h1>
                              </div>                                                  <div class="clearfix">
            <div id="node-28" class="node node-article node-promoted" about="/beast/nucleotide-substitution-models" typeof="sioc:Item foaf:Document">

  
      <span property="dc:title" content="Nucleotide Substitution Models" class="rdf-meta element-hidden"></span>
      <span class="submitted"><span property="dc:date dc:created" content="2014-08-18T11:58:29+01:00" datatype="xsd:dateTime" rel="sioc:has_creator">Mon, 08/18/2014 - 11:58 — <span class="username" xml:lang="" about="/beast/users/rambaut" typeof="sioc:UserAccount" property="foaf:name" datatype="">rambaut</span></span></span>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p><a href="Home.html" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Main Page">BEAST Documentation</a>-&gt;<a href="Tutorials.html" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Tutorials">Tutorials</a>-&gt;Nucleotide Substitution Models</p>
<hr /><h2>Using a nucleotide substitution model other than HKY and GTR</h2>
<p>To create a model that is nested within GTR simply set up the parameters in the GTR model to be shared appropriately. In the case of the Tamura-Nei model (TrN; 1993) all transversions have the same rate and a both transitions have different rates. This can be achieved by the following modification to the standard GTR XML:</p>
<pre>
&lt;gtrModel id="gtr"&gt;
        &lt;frequencies&gt;
            &lt;frequencyModel dataType="nucleotide"&gt;
                &lt;alignment idref="alignment"/&gt;
                &lt;frequencies&gt;
                    &lt;parameter id="gtr.frequencies" dimension="4"/&gt;
                &lt;/frequencies&gt;
            &lt;/frequencyModel&gt;
        &lt;/frequencies&gt;
        &lt;rateAC&gt;
            &lt;parameter id="trn.transversion" value="1.0" lower="0.0"/&gt;
        &lt;/rateAC&gt;
        &lt;rateAG&gt;
            &lt;parameter id="trn.ag" value="1.0" lower="0.0"/&gt;
        &lt;/rateAG&gt;
        &lt;rateAT&gt;
            &lt;parameter idref="trn.transversion"/&gt;
        &lt;/rateAT&gt;
        &lt;rateCG&gt;
            &lt;parameter idref="trn.transversion"/&gt;
        &lt;/rateCG&gt;
        &lt;rateGT&gt;
            &lt;parameter idref="trn.transversion"/&gt;
        &lt;/rateGT&gt;
&lt;/gtrModel&gt;
</pre><p>Notice that the trn.transversion parameter is created once in the rateAC socket and then used subsequently in rateAT, rateCG and rateGT sockets. This ensures that all transversions occur at the same rate of the trn.transversion rate parameter. The transition rateAG is given its own parameter trn.ag. The transition rateCT has a rate of 1.0 - so all other rates are relative to the rate of CT=1.0. It should also be noted that the operator schedule and logs need to be modified. The following scale operaters must be added to the operators element (and the gtr. scaleOperators must be removed).</p>
<pre>
	&lt;scaleOperator scaleFactor="0.5" weight="1"&gt;
		&lt;parameter idref="trn.transversion"/&gt;
	&lt;/scaleOperator&gt;
	&lt;scaleOperator scaleFactor="0.5" weight="1"&gt;
		&lt;parameter idref="trn.ag"/&gt;
	&lt;/scaleOperator&gt;
</pre><p>Likewise the log should have these lines removed:</p>
<pre>
	&lt;parameter idref="gtr.ac"/&gt;
	&lt;parameter idref="gtr.ag"/&gt;
	&lt;parameter idref="gtr.at"/&gt;
	&lt;parameter idref="gtr.cg"/&gt;
	&lt;parameter idref="gtr.gt"/&gt;
</pre><p>and replaced with these:</p>
<pre>
	&lt;parameter idref="trn.transversion"/&gt;
	&lt;parameter idref="trn.ag"/&gt;
</pre><p> </p>
<ul style="list-style-type:square"><li>More examples on <a href="Substitution-model-code.html" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Substitution model code">Substitution model code</a></li>
</ul><p> </p>
<hr /><p><a href="Tutorials.html" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Tutorials">Return to Tutorials</a></p>
</div></div></div>  </div>

  <div class="clearfix">
          <div class="links"></div>
    
      </div>

</div>
          </div>
                          </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

      
    </div> <!-- /#container -->
  </div> <!-- /#wrapper -->
  </body>
</html>
