<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="BEAST_favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="56.html" />
<link rel="canonical" href="bayes-factor.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>Bayes factor | BEAST</title>
  <style type="text/css" media="all">
@import url("system.base.css%3Fou07bk.css");
@import url("system.menus.css%3Fou07bk.css");
@import url("system.messages.css%3Fou07bk.css");
@import url("system.theme.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("field.css%3Fou07bk.css");
@import url("node.css%3Fou07bk.css");
@import url("search.css%3Fou07bk.css");
@import url("user.css%3Fou07bk.css");
@import url("ckeditor.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("style.css%3Fou07bk.css");
</style>
<style type="text/css" media="print">
@import url("print.css%3Fou07bk.css");
</style>

<!--[if lt IE 7]>
<link type="text/css" rel="stylesheet" href="http://sbsweb2-bak.bio.ed.ac.uk/beast/themes/garland/fix-ie.css?ou07bk" media="all" />
<![endif]-->
  <script type="text/javascript" src="jquery.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="jquery.once.js%3Fv=1.2"></script>
<script type="text/javascript" src="drupal.js%3Fou07bk"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/beast\/","pathPrefix":"","ajaxPageState":{"theme":"garland","theme_token":"sMQiivQ9dC6bV1TRvdsLgEuonyBJWrpHREUF3G3A8BY","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ckeditor\/css\/ckeditor.css":1,"themes\/garland\/style.css":1,"themes\/garland\/print.css":1,"themes\/garland\/fix-ie.css":1}}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-56 node-type-article fluid-width" >
  <div id="skip-link">
    <a href="Bayes-factor.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
      
  <div id="wrapper">
    <div id="container" class="clearfix">

      <div id="header">
        <div id="logo-floater">
                              <div id="branding"><strong><a href="index.html">
                          <img src="beast.png" alt="BEAST " title="BEAST " id="logo" />
                        <span>BEAST</span>            </a></strong></div>
                          </div>

        <h2 class="element-invisible">Main menu</h2><ul class="links inline main-menu"><li class="menu-230 first"><a href="index.html">Home</a></li>
<li class="menu-307"><a href="programs.html">Programs</a></li>
<li class="menu-329"><a href="downloads.html">Downloads</a></li>
<li class="menu-312"><a href="tutorials.html" title="Tutorials and documentation on using BEAST">Tutorials</a></li>
<li class="menu-326"><a href="error-messages.html">Error Messages</a></li>
<li class="menu-313 last"><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
</ul>              </div> <!-- /#header -->

      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="index.html">Home</a></div>                    <a id="main-content"></a>
          <div id="tabs-wrapper" class="clearfix">                                <h1 class="with-tabs">Bayes factor</h1>
                              </div>                                                  <div class="clearfix">
            <div id="node-56" class="node node-article node-promoted" about="/beast/bayes-factor" typeof="sioc:Item foaf:Document">

  
      <span property="dc:title" content="Bayes factor" class="rdf-meta element-hidden"></span>
      <span class="submitted"><span property="dc:date dc:created" content="2015-01-29T07:24:43+00:00" datatype="xsd:dateTime" rel="sioc:has_creator">Thu, 01/29/2015 - 07:24 — <span class="username" xml:lang="" about="/beast/users/rambaut" typeof="sioc:UserAccount" property="foaf:name" datatype="">rambaut</span></span></span>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><h1>Bayes factor</h1>
<div id="bodyContent">
<div id="contentSub" style="font-size: 11px; line-height: 1.2em; margin: 0px 0px 1.4em 1em; color: rgb(125, 125, 125); width: auto; font-family: sans-serif;"> </div>
<p><a href="https://web.archive.org/web/20120903075258/http://beast.bio.ed.ac.uk/Main_Page" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Main Page">BEAST Documentation</a>-&gt;<a href="https://web.archive.org/web/20120903075258/http://beast.bio.ed.ac.uk/Tutorials" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Tutorials">Tutorials</a>-&gt; Bayes factor</p>
<p><a id="Identifying_well-supported_rates_using_Bayes_factors" name="Identifying_well-supported_rates_using_Bayes_factors"></a></p>
<h2>Identifying well-supported rates using Bayes factors </h2>
<p>This tutorial describes how to identify rates that are frequently invoked to explain the diffusion process and how to visualize these in Google Earth <a class="external text" href="https://web.archive.org/web/20120903075258/http://earth.google.com/" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://earth.google.com/">Google Earth</a>. The tutorial uses the results obtained by the analysis described in <a href="https://web.archive.org/web/20120903075258/http://beast.bio.ed.ac.uk/BSSVS" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="BSSVS">BSSVS</a>, in particular the rate indicators outputted to the H5N1_HA_discrete_rateMatrix.log file. To analyze the results in this file, we require a tool recently added to the BEAST code (RateIndicatorBF); a recent build that contains this tool can be downloaded at <a class="external text" href="https://web.archive.org/web/20120903075258/http://perswww.kuleuven.be/~u0036765/filesToShare/beast.jar" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://perswww.kuleuven.be/~u0036765/filesToShare/beast.jar">beast.jar</a>. For Google Earth visualization, we will also have to associate each rate with two particular locations and their latitudes and longitudes. We will use the same tab-delimited file prepared in <a href="https://web.archive.org/web/20120903075258/http://beast.bio.ed.ac.uk/Tree_summary" style="text-decoration: none; color: rgb(90, 54, 150); background-image: none; background-position: initial initial; background-repeat: initial initial;" title="Tree summary">Tree summary</a>. For the H5N1 example, this should look like this:</p>
<pre>
Fujian	25.917	118.283
Guangdong	22.87	113.483
Guangxi	23.6417	108.1
Hebei	39.3583	116.6417
Henan	33.875	113.5
HongKong	22.3	114.167
Hunan	27.383	111.517
</pre><p>Importantly, the order of the locations should be the same as in the generalDataType of the beast xml file:</p>
<pre>
	&lt;!-- The general data type for locations                                   --&gt;
	&lt;generalDataType id="geography"&gt;
		&lt;location idref="Fujian"/&gt; 
		&lt;location idref="Guangdong"/&gt; 
		&lt;location idref="Guangxi"/&gt; 
		&lt;location idref="Hebei"/&gt; 
		&lt;location idref="Henan"/&gt; 
		&lt;location idref="HongKong"/&gt; 
		&lt;location idref="Hunan"/&gt; 
	&lt;/generalDataType&gt;
</pre><p>If a KML output for Google Earth visualization is not required, the same file can also be restricted to the locations (without coordinates). If the beast.jar is in the same folder as the H5N1_HA_discrete_rateMatrix.log file, the command below can be used. If this is not the case, the full path to the beast.jar will have to specified. To list the options of the RateIndicatorBF analysis tool, run the beast.jar using the help option:</p>
<pre>
java -cp beast.jar dr.app.tools.RateIndicatorBF -help
</pre><p>There are many options you can explore, but some are not yet fully implemented. For our purposes, we can use:</p>
<pre>
java -cp beast.jar dr.app.tools.RateIndicatorBF -burnin 200  
-pmean 0.693 -poffset 6 -bfcutoff 3 -kml true
 -locationsfile locationCoordinates H5N1_HA_discrete_rateMatrix.log BFtest.out
</pre><p>where "-burnin 200" specifies 200 trees to be discarded as burn-in, "-pmean" specifies the mean of the (truncated) Poisson prior [the default is 0.693 unless specified otherwise], "-offset" specifies the offset of the truncated Poisson prior [the default is also the number of locations - 1], "-bfcutoff" specifies the Bayes factor above which we consider rates to be well -supported, "-kml true" calls for a KML output file, "-locationsfile" specifies the file to which we saved the locations and their coordinates. The last two arguments specify the input and output file.</p>
<p>This should generate a text (BFtest.out) and KML output file. The text file lists the rates yielding a bayes factor above the specified cut-off:</p>
<pre>
Indicator cutoff (for BF = 3.0) = 0.5839295061943813
mean Poisson Prior = 0.693
Poisson Prior offset = 6
I=0.8989450305385897	BF=19.015301372764394: between Fujian (long: 118.283; lat: 25.917) and Guangdong (long: 113.483; lat: 22.87)
I=0.7290394225430317	BF=5.751387858124344: between Guangdong (long: 113.483; lat: 22.87) and Guangxi (long: 108.1; lat: 23.6417)
I=0.7157134925041644	BF=5.381591249719858: between Fujian (long: 118.283; lat: 25.917) and Hebei (long: 116.6417; lat: 39.3583)
I=0.6835091615769017	BF=4.616479904377707: between Henan (long: 113.5; lat: 33.875) and Hunan (long: 111.517; lat: 27.383)
I=0.6274292059966685	BF=3.5998439546800576: between Guangxi (long: 108.1; lat: 23.6417) and HongKong (long: 114.167; lat: 22.3)
</pre><p>Open the KML output (default KMLrates.kml) file in <a class="external text" href="https://web.archive.org/web/20120903075258/http://earth.google.com/" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://earth.google.com/">Google Earth</a>; The rate mapping should look like this:</p>
<div> </div>
</div>
</div></div></div>  </div>

  <div class="clearfix">
          <div class="links"></div>
    
      </div>

</div>
          </div>
                          </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

      
    </div> <!-- /#container -->
  </div> <!-- /#wrapper -->
  </body>
</html>
