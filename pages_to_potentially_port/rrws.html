<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="BEAST_favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="shortlink" href="58.html" />
<link rel="canonical" href="rrws.html" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
  <title>RRWs | BEAST</title>
  <style type="text/css" media="all">
@import url("system.base.css%3Fou07bk.css");
@import url("system.menus.css%3Fou07bk.css");
@import url("system.messages.css%3Fou07bk.css");
@import url("system.theme.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("field.css%3Fou07bk.css");
@import url("node.css%3Fou07bk.css");
@import url("search.css%3Fou07bk.css");
@import url("user.css%3Fou07bk.css");
@import url("ckeditor.css%3Fou07bk.css");
</style>
<style type="text/css" media="all">
@import url("style.css%3Fou07bk.css");
</style>
<style type="text/css" media="print">
@import url("print.css%3Fou07bk.css");
</style>

<!--[if lt IE 7]>
<link type="text/css" rel="stylesheet" href="http://sbsweb2-bak.bio.ed.ac.uk/beast/themes/garland/fix-ie.css?ou07bk" media="all" />
<![endif]-->
  <script type="text/javascript" src="jquery.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="jquery.once.js%3Fv=1.2"></script>
<script type="text/javascript" src="drupal.js%3Fou07bk"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/beast\/","pathPrefix":"","ajaxPageState":{"theme":"garland","theme_token":"FZIgeMTsTa9oJkPBi5bQ3tF6rsi26I3jYo5J3y21xvI","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ckeditor\/css\/ckeditor.css":1,"themes\/garland\/style.css":1,"themes\/garland\/print.css":1,"themes\/garland\/fix-ie.css":1}}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-58 node-type-article fluid-width" >
  <div id="skip-link">
    <a href="rrws.html#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
      
  <div id="wrapper">
    <div id="container" class="clearfix">

      <div id="header">
        <div id="logo-floater">
                              <div id="branding"><strong><a href="index.html">
                          <img src="beast.png" alt="BEAST " title="BEAST " id="logo" />
                        <span>BEAST</span>            </a></strong></div>
                          </div>

        <h2 class="element-invisible">Main menu</h2><ul class="links inline main-menu"><li class="menu-230 first"><a href="index.html">Home</a></li>
<li class="menu-307"><a href="programs.html">Programs</a></li>
<li class="menu-329"><a href="downloads.html">Downloads</a></li>
<li class="menu-312"><a href="tutorials.html" title="Tutorials and documentation on using BEAST">Tutorials</a></li>
<li class="menu-326"><a href="error-messages.html">Error Messages</a></li>
<li class="menu-313 last"><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
</ul>              </div> <!-- /#header -->

      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="index.html">Home</a></div>                    <a id="main-content"></a>
          <div id="tabs-wrapper" class="clearfix">                                <h1 class="with-tabs">RRWs</h1>
                              </div>                                                  <div class="clearfix">
            <div id="node-58" class="node node-article node-promoted" about="/beast/rrws" typeof="sioc:Item foaf:Document">

  
      <span property="dc:title" content="RRWs" class="rdf-meta element-hidden"></span>
      <span class="submitted"><span property="dc:date dc:created" content="2015-01-29T07:26:22+00:00" datatype="xsd:dateTime" rel="sioc:has_creator">Thu, 01/29/2015 - 07:26 — <span class="username" xml:lang="" about="/beast/users/rambaut" typeof="sioc:UserAccount" property="foaf:name" datatype="">rambaut</span></span></span>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><h1>The BEAST Documentation website has now moved to <a href="http://beast.community" target="_self">http://beast.community</a></h1>
<p class="rtecenter"><a href="http://beast.community"><img alt="" src="http://beast.community/images/beast.png" style="height:123px; width:128px" /></a></p>
<h2 class="rtecenter">This page may be out of date.</h2>
<hr /><h2> </h2>
<h1> </h1>
<div id="bodyContent" style="color: rgb(0, 0, 0); font-family: sans-serif; line-height: 19.049999237060547px;">
<h2>Setting up a continuous phylogeographic analysis using relaxed random walks</h2>
<p>This tutorial describes how to modify an XML file that specifies a homogenous Brownian diffusion phylogeographic model to set up relaxed random walks (RRWs, <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://www.ncbi.nlm.nih.gov/pubmed/20203288" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://www.ncbi.nlm.nih.gov/pubmed/20203288">[1]</a>). For the necessary XML additions, we refer to the tutorial describing the standard continuous phylogeographic analysis [ref]. The example XML file for this analysis can be found here (gamma RRW: <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_gammaRRW.xml" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_gammaRRW.xml">[2]</a>, cauchy RRW: <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_cauchyRRW.xml" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_cauchyRRW.xml">[3]</a>, lognormal RRW: <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_LogNRRW.xml" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://code.google.com/p/beast-mcmc/source/browse/trunk/examples/release/Phylogeography/continuous/RacRABV_LogNRRW.xml">[4]</a>) and considers raccoon rabies diffusion in north-eastern United States <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://www.ncbi.nlm.nih.gov/pubmed/17470818" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://www.ncbi.nlm.nih.gov/pubmed/17470818">[5]</a>. RRWs relax the Brownian diffusion assumption that constraints the process to maintain a constant variance over time. They build on uncorrelated relaxed clock models <a class="external autonumber" href="https://web.archive.org/web/20120903075514/http://www.ncbi.nlm.nih.gov/pubmed/16683862" rel="nofollow" style="text-decoration: none; color: rgb(51, 102, 187); background-image: url(https://web.archive.org/web/20120722155546/http://beast.bio.ed.ac.uk/w/skins/monobook/external.png); padding: 0px 13px 0px 0px; background-position: 100% 50%; background-repeat: no-repeat no-repeat;" title="http://www.ncbi.nlm.nih.gov/pubmed/16683862">[6]</a>. By assigning to each branch in the tree a rate scalar to rescale the precision matrix, RRWs allow the underlying process to vary from branch to branch in the tree.</p>
<p>In analogy to relaxed clock models, add a discretizedBranchRates block (before the multivariateTraitLikelihood). For the (one parameter) gamma and Cauchy RRW, this should look like this:</p>
<pre>
	&lt;discretizedBranchRates id="branchRatesDiffusion"&gt;
		&lt;treeModel idref="treeModel"/&gt;
		&lt;distribution&gt;
			&lt;onePGammaDistributionModel id="gammaModel"&gt;
         		&lt;shape&gt;
        			&lt;parameter id="halfDF" value="0.5"/&gt;
        		&lt;/shape&gt;
			&lt;/onePGammaDistributionModel&gt;
		&lt;/distribution&gt;
		&lt;rateCategories&gt;
			&lt;parameter id="branchRatesDiffusion.categories" dimension="92"/&gt;
		&lt;/rateCategories&gt;
	&lt;/discretizedBranchRates&gt;
</pre><p>For the lognormal RRW, we require a logNormalDistributionModel with a mean set to 1.0 in the distribution block instead of the onePGammaDistributionModel:</p>
<pre>
	&lt;discretizedBranchRates id="branchRatesDiffusion"&gt;
		&lt;treeModel idref="treeModel"/&gt;
		&lt;distribution&gt;
			&lt;logNormalDistributionModel meanInRealSpace="true"&gt;
				&lt;mean&gt;
					&lt;parameter id="ucldDiffusion.mean" value="1.0" lower="0.0" upper="10.0"/&gt;
				&lt;/mean&gt;
				&lt;stdev&gt;
					&lt;parameter id="ucldDiffusion.stdev" value="0.1" lower="0.0" upper="10.0"/&gt;
				&lt;/stdev&gt;
			&lt;/logNormalDistributionModel&gt;
		&lt;/distribution&gt;
		&lt;rateCategories&gt;
			&lt;parameter id="branchRatesDiffusion.categories" dimension="92"/&gt;
		&lt;/rateCategories&gt;
	&lt;/discretizedBranchRates&gt;
</pre><p>Add the associated statistics:</p>
<pre>
	&lt;rateStatistic id="meanRateDiffusion" name="meanRate" mode="mean" internal="true" external="true"&gt;
		&lt;treeModel idref="treeModel"/&gt;
		&lt;discretizedBranchRates idref="branchRatesDiffusion"/&gt;
	&lt;/rateStatistic&gt;
	
	&lt;rateStatistic id="coefficientOfVariationDiffusion" name="coefficientOfVariationDiffusion" mode="coefficientOfVariation" internal="true" external="true"&gt;
		&lt;treeModel idref="treeModel"/&gt;
		&lt;discretizedBranchRates idref="branchRatesDiffusion"/&gt;
	&lt;/rateStatistic&gt;
	
	&lt;rateCovarianceStatistic id="covarianceDiffusion" name="covarianceDiffusion"&gt;
		&lt;treeModel idref="treeModel"/&gt;
		&lt;discretizedBranchRates idref="branchRatesDiffusion"/&gt;
	&lt;/rateCovarianceStatistic&gt;
</pre><p>Add the standard operators for the categories of the discretized distributions. For the gamma RRW, we require a scaleOperator on the 'halfDF' parameter (degrees of freedom divided by two). The gamma distribution reduces to Cauchy distribution when the 'halfDF' parameter is fixed to 0.5 (the starting value specified for "halfDF"). Therfore we do not require an operator for the Cauchy distribution.</p>
<pre>
	&lt;operators id="operators" optimizationSchedule="log"&gt;
		.
		.
		.
		&lt;scaleOperator scaleFactor="0.75" weight="6"&gt;
			&lt;parameter idref="halfDF"/&gt;
		&lt;/scaleOperator&gt;
		&lt;swapOperator size="1" weight="30" autoOptimize="false"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/swapOperator&gt;
		&lt;randomWalkIntegerOperator windowSize="2" weight="10.0"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/randomWalkIntegerOperator&gt;
		&lt;uniformIntegerOperator weight="10.0"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/uniformIntegerOperator&gt;
		.
		.
		.
	&lt;/operators&gt;
</pre><p>In case of the lognormal RRW, we need a scaleOperator on the standard deviation of the lognormal distribution (the mean remains fixed to 1.0) instead of the "halfDF":</p>
<pre>
 
	&lt;operators id="operators" optimizationSchedule="log"&gt;
		.
		.
		.
 		&lt;scaleOperator scaleFactor="0.75" weight="3"&gt;
			&lt;parameter idref="ucldDiffusion.stdev"/&gt;
		&lt;/scaleOperator&gt;
		&lt;swapOperator size="1" weight="30" autoOptimize="false"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/swapOperator&gt;
		&lt;randomWalkIntegerOperator windowSize="2" weight="10.0"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/randomWalkIntegerOperator&gt;
		&lt;uniformIntegerOperator weight="10.0"&gt;
			&lt;parameter idref="branchRatesDiffusion.categories"/&gt;
		&lt;/uniformIntegerOperator&gt;
		.
		.
		.
 	&lt;/operators&gt;
</pre><p>We also specify diffuse priors on these additional parameters. For the gamma RWW, this is a gamma prior with shape=0.001 and scale=1000.0:</p>
<pre>
		 &lt;gammaPrior offset="0.0" shape="0.001" scale="1000.0"&gt;
                 	 &lt;parameter idref="halfDF"/&gt;
 		 &lt;/gammaPrior&gt;
</pre><p>For the lognormal RRW, we can use an exponential prior with mean = 10:</p>
<pre>
		 &lt;exponentialPrior mean="10" offset="0"&gt;
 	 	 	 &lt;parameter idref="ucldDiffusion.stdev"/&gt;
	 	 &lt;/exponentialPrior&gt;
</pre><p>We can log these parameters to the screen; gamma RRW:</p>
<pre>
		 &lt;log id="screenLog" logEvery="50000"&gt;
			.
			.
			.
		 	 &lt;column label="halfDF" sf="6" width="12"&gt;
	 	 	 	 &lt;parameter idref="halfDF"/&gt;
	 	 	 &lt;/column&gt;
			.
			.
			.
	 	 &lt;/log&gt;
</pre><p>lognormal RRW:</p>
<pre>
	 	 &lt;log id="screenLog" logEvery="50000"&gt;
			.
			.
			.
 	 	 	 &lt;column label="ucldDiffusion" sf="6" width="12"&gt;
	 	 	 	 &lt;parameter idref="ucldDiffusion.stdev"/&gt;
	 	 	 &lt;/column&gt;
			.
			.
			.
		&lt;/log&gt;
</pre><p>And to the logfile; gamma RRW: </p>
<pre>
		&lt;log id="fileLog" logEvery="50000" fileName="RacRABV_gammaRRW.log"&gt;
			.
			.
			.
			&lt;parameter idref="halfDF"/&gt;
			.
			.
			.
		&lt;/log&gt;
</pre><p>lognormal RRW:</p>
<pre>
		&lt;log id="fileLog" logEvery="50000" fileName="RacRABV_LogNRRW.log"&gt;
			.
			.
			.
			&lt;parameter idref="ucldDiffusion.stdev"/&gt;
			.
			.
			.
		&lt;/log&gt;</pre><p> </p>
</div>
</div></div></div>  </div>

  <div class="clearfix">
          <div class="links"></div>
    
      </div>

</div>
          </div>
                          </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

      
    </div> <!-- /#container -->
  </div> <!-- /#wrapper -->
  </body>
</html>
